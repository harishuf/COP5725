1. Best selling Models.
2. Least selling Models.
3. Minimum number of KMs before users sell.
4. Time online before a care is sold.
5. Categorizing Best Model.
select 
 count(*) as count,  kilometer, yearOfRegistration, 20*round(powerPS/20) as powerPS, 
min(price) as minprice, 
max(price) as maxPrice, 
avg(price) as avgPreis, 
sqrt(variance(price)) as sdPreis from items where 
     yearOfRegistration > 1990 and yearOfRegistration < 2016 
    and price > 100 and price < 100000 
    and powerPS < 600 and powerPS > 0 
 group by yearOfRegistration, round(powerPS/20),kilometer 
having count > 10 
into outfile 'sd.csv' 
fields terminated by ',' lines terminated by '\n';


select count(*) as qty,model_name,fuel_type,vehicle_type,gearbox_type
from model m, used_car u
where m.model_id=u.MODEL_ID
and model_name='polo'
and u.registration_number in
(select registration_number from listing where status='sold')
group by model_name,fuel_type,vehicle_type,gearbox_type;

select table_name,
 to_number(extractvalue(xmltype(dbms_xmlgen.getxml('select count(*) c from '||table_name)),'/ROWSET/ROW/C')) cnt
from all_tables
 where owner = 'manoj'
  and table_name in ('listing','model');

set serveroutput on
DECLARE 
val NUMBER;
BEGIN
FOR I IN (SELECT table_name FROM USER_TABLES where table_name in ('listing','model' ) LOOP
EXECUTE IMMEDIATE 'SELECT count(*) FROM ' || i.table_name INTO val;
DBMS_OUTPUT.PUT_LINE(i.table_name || ' ==> ' || val );
END LOOP;
END;

select (to_char(sysdate,'yyyy') - registration_year) as diff from used_car;
